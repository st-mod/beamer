var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{u7:()=>r,tR:()=>s,Iz:()=>i,tC:()=>c,ct:()=>l,As:()=>a,tH:()=>p,fN:()=>d,Wi:()=>g,Kl:()=>b});const n=[];let o=0;function r(t,e){for(const n of e)for(const e of n){if("string"==typeof e)continue;if(e.tag===t)return e;for(const n of Object.keys(e.options)){const o=e.options[n];if("object"==typeof o){const e=r(t,o);if(void 0!==e)return e}}const n=r(t,e.children);if(void 0!==n)return n}}function s(t,e){const n=[];for(const o of e)for(const e of o)if("string"!=typeof e){e.tag===t&&n.push(e);for(const o of Object.keys(e.options)){const r=e.options[o];"object"==typeof r&&n.push(...s(t,r))}n.push(...s(t,e.children))}return n}function i(t){return c(t.children)}function c(t){if(0===t.length)return"";let e="";for(const n of t[0])e+="string"!=typeof n?i(n):n;return e}function l(t){const e=[];for(const n of t.trim().split(/\s+/))if(/^\d+-$/.test(n))e[Number(n.slice(0,-1))-1]=!0;else if(/^\d+$/.test(n)){const t=Number(n);e[t-1]=!0,e[t]=void 0}else if(/^\d+-\d+$/.test(n)){const[t,o]=n.split("-",2).map(Number);for(let n=t-1;n<o;n++)e[n]=!0;e[o]=void 0}else if(/^-\d+$/.test(n)){const t=Number(n.slice(1));for(let n=0;n<t;n++)e[n]=!0;e[t]=void 0}return e}function a(t){if(0===t.length)return[];const e=t.map(l),n=Math.max(...e.map((t=>t.length)));if(0===n)return[];for(const t of e)if(t.length<n){const e=t[t.length-1];for(let o=t.length;o<n;o++)t[o]=e}return e}function p(t){const e=[],n=[];for(const[,o,r]of t.matchAll(/((?:\^?-?[_a-zA-Z]+[_a-zA-Z0-9-]*\s+)*)([0-9-][0-9-\s]*)(?:\s+|$)/g))e.push(o),n.push(r);const o=a(n);if(0===o.length)return[];const r=o[0].length,s=[];for(let t=0;t<r;t++)s[t]=[];for(let t=0;t<o.length;t++){const n=o[t],r=e[t],i=[],c=[];for(const t of r.trim().split(/\s+/)){if(0===t.length){c.push("invisible");break}t.startsWith("^")?c.push(t.slice(1)):i.push(t)}for(let t=0;t<n.length;t++)n[t]?s[t].push(...i):s[t].push(...c)}return s.map((t=>t.join(" ")))}function d(t){const e=[];for(const n of t.querySelectorAll("[data-slice]")){const t=n.getAttribute("data-slice");if(null===t)continue;const o=p(t);o.length>0&&e.push({element:n,classArray:o})}return e}addEventListener("keydown",(t=>{if(0!==n.length){if("Enter"===t.key){for(let t=0;t<n.length;t++){const{top:e,height:r}=n[t].getBoundingClientRect();if(e+r/2>=0){o=t;break}}return n[o].scrollIntoView(),void document.documentElement.classList.add("showing")}if("Escape"!==t.key)return"ArrowUp"===t.key||"PageUp"===t.key?(t.preventDefault(),void n[o=(o-1+n.length)%n.length].scrollIntoView()):"ArrowDown"===t.key||"PageDown"===t.key?(t.preventDefault(),void n[o=(o+1)%n.length].scrollIntoView()):void 0;document.documentElement.classList.remove("showing")}}));let f="",u="",h="",m=0;const g=async(t,e)=>{const o=r("title",t.children);void 0!==o&&(f="string"==typeof o.options.abbr?o.options.abbr:i(o));const c=s("author",t.children);c.length>0&&(u=c.map((t=>"string"==typeof t.options.abbr?t.options.abbr:i(t))).join(", "));const l=r("date",t.children);void 0!==l&&(h="string"==typeof l.options.abbr?l.options.abbr:i(l)),m++;const a=document.createElement("div");for(let o=0;;o++){const r=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),i=document.createElement("div"),c=document.createElement("main"),l=document.createElement("footer"),p=document.createElement("div"),g=document.createElement("div"),b=document.createElement("div"),v=document.createElement("div");a.append(r),r.append(s),s.append(i),i.append(c),i.append(l),c.append(await e.compileSTDN(t.children)),l.append(p),l.append(g),l.append(b),l.append(v),n.push(r),r.setAttribute("viewBox","0 0 1920 1080"),s.setAttribute("width","100%"),s.setAttribute("height","100%"),p.textContent=u,g.textContent=f,b.textContent=h,v.textContent=m.toString();let y=!1;for(const{element:t,classArray:e}of d(c)){o<e.length-1&&(y=!0);const n=e[Math.min(o,e.length-1)];n.length>0&&t.setAttribute("class",(t.getAttribute("class")??"")+" "+n)}if(!y)break}return a},b=async(t,e)=>{const n=!0===t.options.pause,o=document.createElement("ul");let r=document.createElement("ul");o.append(r);let s=0;for(const t of e.context.indexInfoArray){if("heading"!==t.realOrbit||t.index.length>2)continue;const i=document.createElement("li");i.append(await e.compileSTDN(t.unit.children)),2!==t.index.length?(r=document.createElement("ul"),o.append(i),o.append(r),s++,n&&s>1&&(r.dataset.slice=i.dataset.slice=`${s}-`)):r.append(i)}return o};var v=e.fN,y=e.u7,w=e.tR,E=e.Wi,A=e.Kl,S=e.ct,x=e.As,k=e.tH,I=e.tC,N=e.Iz;export{v as extractSliceableElements,y as findUnit,w as findUnits,E as frame,A as outline,S as parseSliceIndexesStr,x as parseSliceIndexesStrs,k as parseSlicesStr,I as stdnToInlinePlainString,N as unitToInlinePlainString};